---
title: 64bit 환경
date: 2020-11-15 16:37:33
tags:
- Windows 64bit
category:
- Windows
---

## 64bit

- 하위 호환을 위해 32bit CPU를 확장시킨 형태
- 메모리를 16TB까지 쓴다(32bit -> 4GB메모리)
- 32bit에 사용하는 대부분 자료형은 그대로 쓰지만 포인터와 핸들의 크기는 달라졌다.

### WOW

![Wow](/img/wow.PNG)

64비트 윈도우는 하위 호환성을 유지하기 위해서 Wow64.dll/Wow64win.dll/Wow64cpu.dll을 사용한다. 결국 32bit 프로세스가 실행되면 Wow를 이용해서 64bit로 변환해준다.

### 아키텍쳐

- 메모리주소는 64비트 중 48비트만 사용
- 스택은 함수 인자를 레지스터를 사용한다. 또한 인자가 하나더라도 스택 공간을 4개의 공간을 확보한다.
- 64비트 범용 레지스터가 늘어 났다.

### 함수 호출 규약

- fastcall로 통일 
- 처음 4개의 인자는 레지스터에 전달, 그 이상은 스택에 넘긴다
- 스택 정리는 caller가 담당
- 반환 값은 RAX(정수) 또는 XMM0~3(실수)에 저장한다.



