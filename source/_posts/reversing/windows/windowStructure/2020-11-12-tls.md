---
title: TLS
date: 2020-11-14 22:30:18
tags:
- TLS
category:
- Windows
---

## TLS

스레드마다 다른 값을 가지는 전역변수, 즉 스레드가 고유한 저장공간을 갖는다 생각하면 된다. 레이스 컨디션과 메모리 누수를 해결하기위해 도입

### Function

- TlsAlloc(), TlsFree : 동적할당
- __declspec(Thread) int g_value = 0 : 정적할당
- .tls Section에 생성

### TLS Callback Function

프로세스 스레드가 생성/종료될 떄마다 자동으로 호출되는 함수이며 프로세스 진입점 이전에 실행되는 루틴이다. 특히 악성코드에서 안티 디버깅에 주로 쓰인다.
PE의 TLS Directory 구조체에 AddressofCallBacks를 통해 주소 확인이 가능하다.



~

